name: seedvr2-upscaler

# Python runtime
runtime: python3.11

# GPU configuration - A100 40GB should handle the 7B model
machine_type: GPU_A100_40GB

# System dependencies (for OpenCV)
system_packages:
  - libgl1
  - libglib2.0-0

# Python dependencies
requirements:
  - requirements.txt

# Install PyTorch with CUDA support at startup
on_startup:
  - pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu126

# Handler function
handler: fal_handler.handler

# Timeout (1 hour - adjust if needed for longer videos)
timeout: 3600

# Instance scaling
min_instances: 0
max_instances: 5

# Environment variables
env:
  MODEL_CACHE_DIR: /data/models
  PYTORCH_CUDA_ALLOC_CONF: backend:cudaMallocAsync
